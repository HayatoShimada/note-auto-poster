from datetime import datetime
import pytz

class ContentManager:
    def __init__(self):
        """
        曜日ごとのテーマ管理とコンテンツ配信スケジュールを制御するクラス
        """
        # DESIGN.md に定義された曜日テーマ設定
        self.themes = {
            0: { # 月曜日
                "theme": "今週の古着トレンド予報・注目キーワード",
                "instructions": "SNSや海外スナップから分析した、今週注目すべき古着のトレンドアイテムやキーワードを3つピックアップして解説してください。具体的なアイテム名（例: 50s フレンチワークジャケット、90s テック系フリースなど）を出してください。"
            },
            1: { # 火曜日
                "theme": "名作ヴィンテージ・人気ブランドの歴史アーカイブ解説",
                "instructions": "特定の有名ヴィンテージブランド（Levi's, Champion, Patagonia, Barbourなど）の1つの「名作アイテム」にフォーカスし、その歴史、年代判別のポイント、ディテールの魅力を深掘りして解説してください。"
            },
            2: { # 水曜日
                "theme": "日本の古着屋スタッフやインフルエンサーを取り入れた着こなしアイデア",
                "instructions": "日本の気候やトレンドに合わせた、日本人らしい古着の着こなし方・レイヤードスタイルを提案してください。Instagramなどでよく見かけるストリートスナップのような、具体的でマネしやすいコーディネート例を3つほど紹介してください。"
            },
            3: { # 木曜日
                "theme": "海外の古着屋スタッフやインフルエンサーを取り入れた着こなしアイデア",
                "instructions": "海外（アメリカ、ヨーロッパ等）の古着屋スタッフや海外インフルエンサーならではの、少し無骨で自由な発想のスタイリングやサイズ選びのコツを提案してください。海外スナップ特有の雰囲気を出すポイントを解説してください。"
            },
            4: { # 金曜日
                "theme": "週末の古着屋ポップアップ・フリマ・イベント情報まとめ",
                "instructions": "今週末に行きたい古着関連のイベント（下北沢、高円寺、原宿などでのポップアップや、フリマ・ヴィンテージマーケット）を想定し、イベントの楽しみ方やヴィンテージマーケットでの賢い買い方のコツ（ディグり方）を紹介してください。架空のイベント情報ではなく、一般的な参加の心構えやアドバイスを中心にします。"
            },
            5: { # 土曜日
                "theme": "特定ジャンルの深掘り特集",
                "instructions": "今回は「ミリタリー」「ワーク」「ユーロヴィンテージ」「スポーツレトロ」のいずれかのジャンルを1つ選び、その魅力と代表的なアイテム、選び方のポイントをマニアックになりすぎない範囲で詳しく解説してください。"
            },
            6: { # 日曜日
                "theme": "今週のおさらい・1週間まとめショートコラム",
                "instructions": "今週の古着・ファッションに関するちょっとしたニュース、フリマアプリでの動向、または古着のお手入れ・メンテナンス方法（洗濯、匂い取り、保管）などのお役立ち情報をコラム形式でまったりと書いてください。"
            }
        }

    def get_todays_theme(self) -> dict:
        """
        実行日の曜日に基づいたテーマと指示を取得する
        日本時間(JST)基準で曜日を判定する
        
        Returns:
            dict: {"theme": str, "instructions": str}
        """
        jst = pytz.timezone('Asia/Tokyo')
        now_jst = datetime.now(jst)
        weekday = now_jst.weekday() # 0: 月曜, ..., 6: 日曜
        
        return self.themes.get(weekday, {
            "theme": "古着についてのコラム", 
            "instructions": "古着に関する自由なコラムを書いてください"
        })
